<nav class="navbar-container">
  <div class="navbar-content">
    
    <a routerLink="/home" class="brand">
      <span class="brand-text">Trip<span class="highlight">Share</span></span>
    </a>

    <div class="nav-links" *ngIf="isLoggedIn">
      <a routerLink="/home" routerLinkActive="active-link" [routerLinkActiveOptions]="{exact: true}">Inicio</a>
      <a routerLink="/trips" routerLinkActive="active-link">Mis Viajes</a>
    </div>

    <div class="nav-actions">
      
      <button class="icon-btn theme-btn" (click)="themeService.toggleTheme()">
        {{ themeService.currentTheme() === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™' }}
      </button>

      <ng-container *ngIf="!isLoggedIn">
        <button class="btn-login" routerLink="/login">Entrar</button>
        <button class="btn-register" routerLink="/register">Registrarse</button>
      </ng-container>

      <div class="user-controls" *ngIf="isLoggedIn">
        
        <div class="notification-wrapper">
          <button type="button" class="icon-btn notification-btn" (click)="toggleNotifications()">
            ğŸ”” <span class="badge-dot" *ngIf="notificationCount > 0"></span>
          </button>

          <div class="notification-dropdown fade-in" *ngIf="isNotificationsOpen">
            <div class="notif-header">Notificaciones</div>
            <div class="notif-list" *ngIf="pendingRequests.length > 0">
              <div class="notif-item" *ngFor="let req of pendingRequests">
                <div class="notif-content">
                  <span class="notif-text"><strong>{{ req.fromUserName }}</strong> te enviÃ³ solicitud.</span>
                  <div class="notif-actions">
                    <button class="btn-accept" (click)="acceptRequest(req.id)">Aceptar</button>
                    <button class="btn-reject" (click)="rejectRequest(req.id)">Rechazar</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="notif-empty" *ngIf="pendingRequests.length === 0">
              <p>No tienes notificaciones.</p>
            </div>
          </div>
        </div>

        <div class="avatar-dropdown-wrapper">
          <button type="button" class="avatar-btn" (click)="toggleDropdown()">
            <img [src]="userAvatar" class="nav-avatar" alt="Avatar">
          </button>
          
          <div class="dropdown-menu fade-in" *ngIf="isDropdownOpen">
            <div class="dropdown-header">
              <span class="dropdown-name">{{ userName }}</span>
              <span class="dropdown-email">Viajero</span>
            </div>
            <hr>
            
<a routerLink="/profile" (click)="closeAllMenus()" class="dropdown-item">ğŸ‘¤ Mi Perfil</a>
<a routerLink="/friends" (click)="closeAllMenus()" class="dropdown-item">ğŸ‘¥ Mis Amigos</a>
            
            <a (click)="logout()" class="dropdown-item text-danger">ğŸšª Cerrar SesiÃ³n</a>
          </div>
        </div>

        <div class="overlay" *ngIf="isDropdownOpen || isNotificationsOpen" (click)="closeAllMenus()"></div>

      </div>
    </div>
  </div>
</nav>